<!doctype html><html lang=en-us prefix="og: https://ogp.me/ns#"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-security-policy content="form-action 'none'; upgrade-insecure-requests; block-all-mixed-content; base-uri 'none'"><meta property="og:title" content="archlinuxでセキュアブート(簡易版) - 忘れないように... 2"><title>archlinuxでセキュアブート(簡易版) - 忘れないように... 2</title><meta property="og:description" content><meta name=description content><meta property="og:author" content="soracat"><meta property="og:url" content="https://soracqt.github.io/posts/2021-03-09-arch-secureboot/"><link rel=stylesheet href="/scss/main.min.e31351cf7100a4f64271b6d799eaf8b968d1e6f2c5191d585f16371906f32e72.css"><link rel=icon href=../../favicon/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=../../favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon/favicon-16x16.png><meta property="og:image" content="/favicon/og-image.png"></head><body><div class=header-nav><header><a href=../../><img src alt=icon width=50 height=50><h1>忘れないように... 2</h1></a></header><nav><a href=../../tags/ title>Tags</a></nav></div><div class=article-labels><div class=tags><p><a href=../../tags>Tags:</a> <a href=../../tags/archlinux>[archlinux]</a> <a href=../../tags/secureboot>[secureboot]</a> <a href=../../tags/bootloader>[bootloader]</a> <a href=../../tags/efi>[efi]</a></p></div></div><main><article><div class=article-header><h1>archlinuxでセキュアブート(簡易版)</h1><span class=author-date><p>By <a href=https://github.com/soracqt>soracat</a> · Made at: 2021/03/09</p></span></div><div class=article-content><h1 id=grubの場合>grubの場合
<a class=anchor href=#grub%e3%81%ae%e5%a0%b4%e5%90%88>🔗</a></h1><p>bootパーティションが/bootにマウントされていてefiパーティションが/boot/efiにマウントされている例です</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yay -S shim-signed
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo cp /usr/share/shim-signed/shimx64.efi /boot/efi/EFI/arch/BOOTX64.efi
</span></span><span style=display:flex><span>sudo cp /usr/share/shim-signed/mmx64.efi /boot/efi/EFI/arch/
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#81a1c1>cd</span> ~
</span></span><span style=display:flex><span>sudo efibootmgr --verbose --disk /dev/nvme0n1 --part <span style=color:#b48ead>1</span> --create --label <span style=color:#a3be8c>&#34;Shim&#34;</span> --loader /EFI/arch/BOOTX64.efi
</span></span></code></pre></div><p>あとはBOOTX64.efiを起動してgrubx64.efiのhashを登録する</p><p><a href=https://wiki.archlinux.jp/index.php/%E3%82%BB%E3%82%AD%E3%83%A5%E3%82%A2%E3%83%96%E3%83%BC%E3%83%88>https://wiki.archlinux.jp/index.php/%E3%82%BB%E3%82%AD%E3%83%A5%E3%82%A2%E3%83%96%E3%83%BC%E3%83%88</a></p><h1 id=systemd-bootの場合>systemd-bootの場合
<a class=anchor href=#systemd-boot%e3%81%ae%e5%a0%b4%e5%90%88>🔗</a></h1><p>/bootがfat32になっている場合です</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yay -S preloader-signed
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo cp /usr/share/preloader-signed/<span style=color:#81a1c1>{</span>PreLoader,HashTool<span style=color:#81a1c1>}</span>.efi /boot/EFI/systemd
</span></span><span style=display:flex><span>sudo mv /boot/EFI/systemd/systemd-bootx64.efi /boot/EFI/systemd/loader.efi
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#81a1c1>cd</span> ~
</span></span><span style=display:flex><span>sudo efibootmgr --verbose --disk /dev/nvme0n1 --part <span style=color:#b48ead>1</span> --create --label <span style=color:#a3be8c>&#34;PreLoader&#34;</span> --loader /EFI/systemd/PreLoader.efi
</span></span></code></pre></div><p>どちらもカーネルとefiバイナリのhashを登録しないと起動しません</p><p>ここでハマりました</p><p><a href=https://wiki.archlinux.jp/index.php/%E3%82%BB%E3%82%AD%E3%83%A5%E3%82%A2%E3%83%96%E3%83%BC%E3%83%88>https://wiki.archlinux.jp/index.php/%E3%82%BB%E3%82%AD%E3%83%A5%E3%82%A2%E3%83%96%E3%83%BC%E3%83%88</a></p></div></article></main><div class=article-related><p>Previous: <a href=https://soracqt.github.io/posts/2021-02-27-cjk-input-in-minecraft1.12-on-linux/>LinuxのMinecraft 1.12.xで日本語入力</a></p><p>Next: <a href=https://soracqt.github.io/posts/2021-03-17-fontchange-in-flatpak/>Flatpakアプリケーションでのフォント変更方法</a></p></div><div class=article-license></div><footer><p>© 2022 - soracat</footer></body></html>